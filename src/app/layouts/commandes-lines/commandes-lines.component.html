@if (loadUserData) {
<div class="text-center d-flex justify-content-center align-items-center">
    <div class="spinner-border bs-primary" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
</div>
}@else {
@if (isLoadingData) {
<div class="text-center d-flex justify-content-center align-items-center">
    <div class="spinner-border bs-primary" role="status">
        <span class="visually-hidden">Loading...</span>
    </div>
</div>
} @else {
@if (currentUser && commande) {
<!-- Page Wrapper -->
<div class="page-wrapper">
    <div class="content">
        <div class="row">
            <div class="col-md-12">
                <!-- Page Header -->
                <div class="page-header">
                    <div class="row align-items-center">
                        <div class="col-8">
                            <h4 class="page-title">
                                Commandes
                                <span class="count-title">#{{ commande.ncommande }}</span>
                            </h4>
                            <!-- <h6>Germain kataku</h6> -->
                        </div>
                        <div class="col-4 text-end">
                            <div class="head-icons">
                                <a [routerLink]="routes.commandeList" data-bs-toggle="tooltip" data-bs-placement="top"
                                    data-bs-original-title="Refresh"><i class="ti ti-refresh-dot"></i></a>
                                <a href="javascript:void(0);" data-bs-toggle="tooltip" data-bs-placement="top"
                                    data-bs-original-title="Collapse" id="collapse-header"><i
                                        class="ti ti-chevrons-up"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /Page Header -->

                <!-- Card -->
                <div class="card">
                    <div class="card-header">
                        <div class="row align-items-center">
                            <div class="d-flex align-items-center flex-wrap row-gap-2 justify-content-sm-end">
                                <h4 style="padding-right: 10px;">Panier client : </h4>
                                <a href="javascript:void(0);" class="btn btn-outline-primary position-relative"
                                    data-bs-toggle="offcanvas" data-bs-target="#offcanvas_view"><i
                                        class="ti ti-shopping-cart me-2" style="size: 40px;"></i>
                                    <span
                                        class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                                        {{ totalLength() }}
                                    </span>
                                    <span>{{ formatCurrency(total, currentUser.currency) }}</span>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="card-header">
                        <!-- Search -->
                        <div class="row align-items-center">
                            <div class="col-sm-12">
                                <div class="icon-form mb-3 mb-sm-0">
                                    <span class="form-icon"><i class="ti ti-search"></i></span>
                                    <input type="text" #input [(ngModel)]="search"
                                        (ngModelChange)="onSearchChange($event)" class="form-control"
                                        placeholder="Search Contacts">
                                </div>
                            </div>
                        </div>
                        <!-- /Search -->
                    </div>
                    <div class="card-body"> 
                        <div class="row">
                            @for (item of dataList; track item.ID) {
                            <div class="col-xxl-3 col-xl-4 col-md-6">
                                <app-prod-item [currentUser]="currentUser" [commandeId]="commandeId"
                                    [item]="item"></app-prod-item>
                            </div>
                            }
                        </div> 
                    </div>
                </div>
                <!-- /Card -->

            </div>
        </div>
    </div>
</div>
<!-- /Page Wrapper -->

<!--View cart -->
<div class="offcanvas offcanvas-end offcanvas-large" tabindex="-1" id="offcanvas_view">
    <div class="offcanvas-header border-bottom justify-content-between">
        <h4>Facture <span class="text-purple ms-2">#{{ commande.ncommande }}</span></h4>
        <div class="d-flex align-items-center">
            <div class="toggle-header-popup">
                <div class="dropdown table-action me-2">
                    <a href="javascript:void(0);" class="btn btn-dropdowns dropdown-toggle" data-bs-toggle="dropdown"
                        aria-expanded="false">
                        <div style="margin-right: 10px;">
                            <i class="fa-solid fa-print"></i>
                        </div>
                        Download
                    </a>
                    <div class="dropdown-menu dropdown-menu-right">
                        <!-- <a class="dropdown-item" href="javascript:void(0);"> Download </a> -->
                        <a class="dropdown-item" href="javascript:void(0);" (click)="generatePdf()">
                            Facture PDF
                        </a>
                    </div>
                </div>
            </div>
            <button type="button"
                class="btn-close custom-btn-close border p-1 me-0 d-flex align-items-center justify-content-center rounded-circle"
                data-bs-dismiss="offcanvas" aria-label="Close">
                <i class="ti ti-x"></i>
            </button>
        </div>
    </div>
    <div class="offcanvas-body ">
        <app-cmd-facture [currentUser]="currentUser" [commande_id]="commande.ID!" [commande]="commande"
            [commandeLineList]="commandeLineList"></app-cmd-facture>
    </div>
</div>
<!-- /View cart -->

}
}
}